From c3372cf9ef5d9ae8bddb20073ebfba2d9d2f5a66 Mon Sep 17 00:00:00 2001
From: Matthew Waters <matthew@centricular.com>
Date: Fri, 19 Oct 2018 16:42:54 +1100
Subject: [PATCH] android/build: switch to using the c++_shared c++ library

It's the only stl available starting from NDK r18
---
 build/platform-android.mk | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/build/platform-android.mk b/build/platform-android.mk
index 6f6ce34..4db2be0 100644
--- a/build/platform-android.mk
+++ b/build/platform-android.mk
@@ -49,6 +49,7 @@ CFLAGS += -isystem $(NDKROOT)/sysroot/usr/include -isystem $(NDKROOT)/sysroot/us
 CXXFLAGS += -fno-rtti -fno-exceptions
 LDFLAGS += --sysroot=$(SYSROOT)
 SHLDFLAGS = -Wl,--no-undefined -Wl,-z,relro -Wl,-z,now -Wl,-soname,lib$(PROJECT_NAME).so
+STATIC_LDFLAGS=`pkg-config --libs gnustl`
 
 ifeq ($(NDK_TOOLCHAIN_VERSION), clang)
   HOST_OS = $(shell uname -s | tr [A-Z] [a-z])
@@ -82,9 +83,9 @@ endif
 endif
 
 STL_INCLUDES = \
-    -I$(NDKROOT)/sources/cxx-stl/stlport/stlport
+    -I$(NDKROOT)/sources/cxx-stl/llvm-libc++/include
 STL_LIB = \
-    $(NDKROOT)/sources/cxx-stl/stlport/libs/$(APP_ABI)/libstlport_static.a
+    $(NDKROOT)/sources/cxx-stl/llvm-libc++/libs/$(APP_ABI)/libc++_shared.so
 
 GTEST_INCLUDES = $(STL_INCLUDES)
 CODEC_UNITTEST_INCLUDES = $(STL_INCLUDES)
-- 
2.25.1

